mkdir Mahmoud_tests
cd Mahmoud_tests
sudo apt install python3-pip
sudo pip3 install transformers
sudo pip3 install torch
sudo pip3 install sentencepiece
touch PMC_test.py
vim PMC_test.py
[then press 'i' to start editing and paste the following code]
[after you paste it, press ESC, then type ':wq']
[then run 'python3 PMC_test.py']

import transformers
import torch
tokenizer = transformers.LlamaTokenizer.from_pretrained('axiong/PMC_LLaMA_13B')
model = transformers.LlamaForCausalLM.from_pretrained('axiong/PMC_LLaMA_13B')
model.cuda()  # move the model to GPU

prompt_input = (
    'Below is an instruction that describes a task, paired with an input that provides further context.'
    'Write a response that appropriately completes the request.\n\n'
    '### Instruction:\n{instruction}\n\n### Input:\n{input}\n\n### Response:'
)

example = {
    "instruction": ("I will give you a text of a youtube video, and I want you to evaluate this text based on the following metrics:"
    "1. Are the aims clear?"
    "2. Does it achieve its aims?"
    "3. Is it relevant?"
    "4. Is it clear what sources of information were used to compile the publication (other than the author or producer)?"
    "5. Is it clear when the information used or reported in the publication was produced?"
    "6. Is it balanced and unbiased?"
    "7. Does it provide details of additional sources of support and information?"
    "8. Does it refer to areas of uncertainty?"
    "9. Does it describe how each treatment works?"
    "10. Does it describe the benefits of each treatment?"
    "11. Does it describe the risks of each treatment?"
    "12. Does it describe what would happen if no treatment is used?"
    "13. Does it describe how the treatment choices affect overall quality of life?"
    "14. Is it clear that there may be more than one possible treatment choice?"
    "15. Does it provide support for shared decision-making?"
    "For each question, give me an integer from 1 to 5 (1: no, 3 partially, 5 yes)"
    "Give me the scores in this format: [x, x, x, x, x, x, x, x, x, x, x, x, x, x, x, x]"),
    "input": (
        "Here is the text:"
        "Many diabetes care organizations create algorithms for antihyperglycemic therapy in adults. They are important consultation tools for physicians creating individualized patient treatment plans. The algorithm for this course is based on the 2018 American Diabetes Association, ADA, algorithm. After this explanatory module, you'll have the opportunity to both download a printable copy and explore an interactive version of our treatment algorithm. (key clicking) It is organized by A1C results and contains four main therapy categories. Monotherapy, dual therapy, triple therapy, and combination injection therapy. Each therapy offers some basic information about standard drug classifications for diabetes treatment, includes lifestyle management in tandem with pharmaceutical suggestion, and each tier of the algorithm is designed to be reevaluated for efficacy every three months. Your patient's treatment should be adjusted as needed based on the results of their regular evaluations. Let's take closer look at monotherapy. Monotherapy should be considered for individuals younger than 60 years old, with pre-diabetes, a BMI greater than 35, and women with a history of gestational diabetes, GDM. It can also be used for first line therapy, if the A1C is less than 9%. These therapies highlight important factors that are different for each agent, such as the general efficacy of the agent, the risk of hypoglycemia, how likely the agent is to affect the patient's weight, or other general side effects or comorbidities that need to be taken into consideration, and the cost of treatment. Determining which agents are best for your patient's treatment requires weighing these factors with the patient's lifestyle and capacity for additional lifestyle management changes. The next step is dual therapy, where we see examples of how to balance multiple agents in treatment. Dual therapy is suggested for patients with an A1C equal to or greater than 9%, but less than 10%. The treatment includes lifestyle management strategies, metformin, and an additional agent. Possible secondary agents include SGLT2 inhibitors, GLP-1 Agonist, DPP-4 inhibitors, TZDs, second generation sulfonylureas, and insulin. Patient factors play a critical role in deciding which agents will be best. For example, a TZD would be contraindicated for a patient who has a history of congestive heart failure, as these agents have the potential for increased water retention and weight gain. Therapies should be designed to encourage maximum potential for adherence. Spending time learning about your patient's day-to-day routine and lifestyle patterns is time well spent for the right fit. A patient who expresses an inability to alter a busy lifestyle to balance frequent medication regimens, in using an agent with the highest efficacy and least-frequent dosing requirements, even if it means a higher cost and potential weight gain. It then becomes important to counsel them on other lifestyle management changes to offset the risk of weight gain. If the patient's A1C is not at target after three months, on mono- and/or dual therapy, triple therapy could be considered, adding a second additional agent. When a patient is not showing improvement with previous therapies, assessing medication adherence before adding another agent is crucial. It is also prudent to review the patient's recent medical history to ensure no other changes in health or medication could be interfering with the current treatment regimen or represent potential contraindications that were not an issue under previous regimens. Talk to your patient on how each option will affect and be affected by their own lifestyle and medication adherence. Combination insulin therapy should be considered when the A1C is equal to or greater than 10%, blood glucose is greater than or equal to 300 milligrams per deciliter, or the patient has symptoms of hyperglycemia. It is not uncommon for patients to be wary of introducing an injectable medication and therefore it is important to discuss the pros and cons with your patients, and be sensitive to the extra support they may need adjusting to the idea and practice of regular injections. This section of the algorithm gives you guidelines for how to start, when to adjust, and how to manage the increased risk of hypoglycemia. This concludes our overview of the algorithm. You may now advance to the interactive algorithm, which allows you to click around each layer of the algorithm to learn more about the agents, how they work, and what the current research indicates."
    )
}
input_str = [prompt_input.format_map(example)]

model_inputs = tokenizer(
    input_str,
    return_tensors='pt',
    padding=True,
)
print( f"\033[32mmodel_inputs\033[0m: { model_inputs }" )


topk_output = model.generate(
    model_inputs.input_ids.cuda(),
    max_new_tokens=1000,
    top_k=50
)
output_str = tokenizer.batch_decode(topk_output)
print('model predict: ', output_str[0])